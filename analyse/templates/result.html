{% load staticfiles %}
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
          <meta name="viewport" content="width=device-width, initial-scale=1">
          <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
          <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script> 
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.bundle.min.js" ></script>
          
     <style type="text/css">
     	.container
     	{
     		border-radius: 25px;
		    border: 2px solid black;
		    padding: 40px; 
     	}


     </style>
</head>
<body >
		
		<div class="container">
              <div class="row">
                  <div class="col-md-4" >
               			<form action="form_action.asp">
						{% for spec,sent in data %}
						<label><input type="radio" name="feature" value={{sent}} id={{spec}}>  {{spec}}</label>
						<hr></hr>
						{% endfor %}						
						</form>
                  </div>
                  <div  class="col-md-8" >
                    <h1 id ="heading" >Select any item </h1>
                    <hr></hr>	
					<canvas id="chart" width="500" height="200px"></canvas>

					<div class="comments positive">
					<ul id="positive-comments">
					<!-- javascript prints comments here by parsing JSON obj -->
					</ul>
					</div>

					<div class="comments negative">

					</div>
                  </div>
              </div>
          </div>



<script>

//when documnet is completely loaded load this scripts
$(document).ready(function(){

	radioButtonClickListener();
	displayComments();
});


//global variables
var myChart;

function radioButtonClickListener() {

	$('input[type=radio][name=feature]').change(function() {

		var heading = $(this).attr("id");
		var value = $(this).val();

		//set chart heading
		$("#heading").text(heading);

		//load chart
		displayChart(value);

	});
}

function displayChart(value) {

	//destroy existing chart if any and load new chart
	if(myChart != null){					
					
		myChart.destroy();
	}	

	//creation of new chart
	var ctx = $("#chart");
	myChart = new Chart(ctx, {
    type: 'doughnut',
    data : {
    labels: [
        "Positive",
        "Negative"
    ],
    datasets: [
        {
            data: [value, (10.0 - value).toFixed(1)],
            backgroundColor: [
                "#5cd65c",
                "#ff4d4d"
            ],
            hoverBackgroundColor: [
                "#2eb82e",
                "#ff1a1a"
            ]
        }]
}
});
}
function displayComments() {
	
	var obj = {{ comments|safe}};

	for (var key in obj) {
    	if (obj.hasOwnProperty(key)) {
        	//console.log(obj[key]);
        	var comments = obj[key];
        //where to append lists	
        var positiveComments = $('#positive-comments')

        //appending loop
		$.each(obj[key], function(i) {
    	 
    		var li = $('<li/>')
        	.text(comments[i])
        	.appendTo(positiveComments);

		});	
    }
}
}
</script>

</body>
</html>
